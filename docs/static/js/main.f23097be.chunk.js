(this.webpackJsonpminesweeper=this.webpackJsonpminesweeper||[]).push([[0],{21:function(t,e,n){},22:function(t,e,n){},23:function(t,e,n){},24:function(t,e,n){},26:function(t,e,n){"use strict";n.r(e);var i=n(1),o=n.n(i),r=n(15),s=n.n(r),a=(n(21),n(22),n(2)),c=n(3),u=n(4),h=n(6),d=(n(23),n(11)),l=(n(24),n(13)),f=n(7);function v(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.flatMap((function(t){return String(t)===t||t instanceof Array?t:Object.entries(t).filter((function(t){var e=Object(f.a)(t,2);e[0];return e[1]})).map((function(t){var e=Object(f.a)(t,2),n=e[0];e[1];return n}))})).join(" ")}var p=function t(e){var n=this;Object(a.a)(this,t),this.timerId=0,this.values=[],this.duration=80,this.cb=void 0,this.next=function(t){n.timerId&&clearTimeout(n.timerId),n.timerId=window.setTimeout(n.flush,n.duration),n.values.push(t.buttons)},this.flush=function(){n.cb&&n.cb(Math.max.apply(Math,Object(l.a)(n.values))),n.values=[],n.timerId=0},this.cb=e};function b(t,e){if(null==e){var n=[0,t];t=n[0],e=n[1]}return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t))+t}var m=n(0),g=function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(t){var i;return Object(a.a)(this,n),(i=e.call(this,t)).state={content:"",enabled:!0},i.click=void 0,i.settings=void 0,i.open=function(){i.settings.isOpen=!0,i.setState({content:i.settings.isMine?"\ud83d\udca3":(i.settings.value||"").toString()})},i.mark=function(t){i.settings.isOpen||(i.settings.isMarked=null!==t&&void 0!==t?t:!i.settings.isMarked,i.setState({content:i.settings.isMarked?"\ud83d\udea9":""}))},i.lookup=function(){var t,e;if(i.settings.isOpen&&i.settings.value){var n=null===(t=i.settings.board)||void 0===t?void 0:t.getAround(i.settings),o=null!==(e=null===n||void 0===n?void 0:n.reduce((function(t,e){return t+Number(e.isMarked)}),0))&&void 0!==e?e:0;i.props.lookup&&i.settings.value===o&&i.props.lookup(i.settings)}},i.onClick=function(t){if(i.state.enabled)switch(t){case 1:i.settings.isMarked||(i.props.move&&i.props.move(i.settings),i.open());break;case 2:i.mark();break;case 3:i.lookup()}},i.disable=function(){i.setState({enabled:!1})},i.click=new p(i.onClick),i.settings=t.field,i.settings.component=Object(d.a)(i),i}return Object(c.a)(n,[{key:"render",value:function(){return Object(m.jsx)("div",{className:v("field",{open:this.settings.isOpen},"around".concat(this.settings.value)),onContextMenuCapture:this.mouseCapture,onMouseDown:this.click.next,children:this.state.content})}},{key:"mouseCapture",value:function(t){t.preventDefault(),t.nativeEvent.preventDefault()}}]),n}(o.a.Component),k=n(16),O=function t(e){Object(a.a)(this,t),this.value=0,this.x=0,this.y=0,this.isOpen=!1,this.isMine=!1,this.isMarked=!1,this.component=void 0,this.board=void 0,Object.assign(this,e)},j={Beginner:{width:9,height:9,mines:10},Intermediate:{width:16,height:16,mines:40},Expert:{width:30,height:16,mines:99}},w=function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(){var t;Object(a.a)(this,n);for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return(t=e.call.apply(e,[this].concat(o))).fields=[],t.board=[],t.minesFields=[],t.width=10,t.height=10,t.mines=5,t.getAround=function(e){var n=e.x,i=e.y;return[[n-1,i-1],[n,i-1],[n+1,i-1],[n-1,i],[n+1,i],[n-1,i+1],[n,i+1],[n+1,i+1]].filter((function(e){var n=Object(f.a)(e,2),i=n[0],o=n[1];return i>=0&&i<t.width&&o>=0&&o<t.height})).map((function(e){var n=Object(f.a)(e,2),i=n[0],o=n[1];return t.board[i][o]}))},t.lookup=function(e){var n=[];return function e(i){var o=t.getAround(i).filter((function(t){return!n.includes(t)&&!t.isMarked}));n.push.apply(n,Object(l.a)(o)),o.filter((function(t){return!t.value})).forEach(e)}(e),n},t}return Object(c.a)(n,[{key:"createBoard",value:function(t){Object.assign(this,t),console.log("BoardState.createBoard"),this.fields=[],this.minesFields=[],this.board=[];for(var e=0;e<this.width;e++)this.board[e]=[];for(var n=0;n<this.height;n++)for(var i=0;i<this.width;i++)this.board[i][n]=new O({x:i,y:n,value:0,board:this}),this.fields.push(this.board[i][n])}},{key:"fillBoard",value:function(t){for(var e=this,n=this.mines;n;){var i=b(this.width),o=b(this.height);this.board[i][o].isMine||i===t.x||o===t.y||(this.minesFields.push(this.board[i][o]),this.board[i][o].isMine=!0,n--)}this.minesFields.forEach((function(t){e.getAround(t).forEach((function(t){return t.value++}))}))}}]),n}(Object(k.a)(Array)),M=function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(t){var i;return Object(a.a)(this,n),(i=e.call(this,t)).board=new w,i.timer=0,i.timerId=0,i.state={won:null},i.tick=function(){i.timer++},i.move=function(t){if(i.timer||(i.board.fillBoard(t),i.timer=1,i.timerId=window.setInterval(i.tick,1e3)),t.isMine)return i.gameOver();i.checkWin(t)||t.value||i.lookup(t)},i.lookup=function(t){if(!t.isMarked){var e=i.board.lookup(t);return e.forEach((function(t){var e;return null===(e=t.component)||void 0===e?void 0:e.open()})),e.find((function(t){return t.isMine}))?i.gameOver():i.checkWin(),e}},i.board.createBoard(i.props),window.board=i.board,i}return Object(c.a)(n,[{key:"render",value:function(){var t=this;console.log("Board.render",this.board);var e={"--columns":this.props.width,"--rows":this.props.height};return Object(m.jsx)("div",{className:v("board",{win:!0===this.state.won,loose:!1===this.state.won}),style:e,children:this.board.fields.map((function(e){return Object(m.jsx)(g,{field:e,move:t.move,lookup:t.lookup},"".concat(e.x,".").concat(e.y))}))})}},{key:"checkWin",value:function(t){if(!this.board.fields.find((function(e){return!e.isMine&&!e.isOpen&&t!==e})))return console.log("Win!"),this.stop(),this.setState({won:!0}),this.board.minesFields.forEach((function(t){var e;return null===(e=t.component)||void 0===e?void 0:e.mark(!0)})),!0}},{key:"stop",value:function(){clearInterval(this.timerId),this.board.fields.forEach((function(t){var e;return null===(e=t.component)||void 0===e?void 0:e.disable()}))}},{key:"gameOver",value:function(){this.setState({won:!1}),console.log("game over"),this.board.minesFields.forEach((function(t){var e;return null===(e=t.component)||void 0===e?void 0:e.open()})),this.stop()}}]),n}(o.a.Component),y={settings:{width:12,height:8,mines:12}};var x=function(){var t=j.Beginner||y;return Object(m.jsx)("div",{className:"App",children:Object(m.jsx)(M,{width:t.width,height:t.height,mines:t.mines})})},I=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,27)).then((function(e){var n=e.getCLS,i=e.getFID,o=e.getFCP,r=e.getLCP,s=e.getTTFB;n(t),i(t),o(t),r(t),s(t)}))};s.a.render(Object(m.jsx)(o.a.StrictMode,{children:Object(m.jsx)(x,{})}),document.getElementById("root")),I()}},[[26,1,2]]]);
//# sourceMappingURL=main.f23097be.chunk.js.map