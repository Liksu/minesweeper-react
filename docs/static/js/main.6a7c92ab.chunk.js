(this.webpackJsonpminesweeper=this.webpackJsonpminesweeper||[]).push([[0],{25:function(t,e,n){},26:function(t,e,n){},27:function(t,e,n){},28:function(t,e,n){},30:function(t,e,n){"use strict";n.r(e);var i=n(1),s=n.n(i),o=n(19),r=n.n(o),a=(n(25),n(20)),u=(n(26),n(2)),l=n(4),c=n(3),h=n(7),d=(n(27),n(18)),f=n(12),v=(n(28),n(8));function g(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.flatMap((function(t){return String(t)===t||t instanceof Array?t:Object.entries(t).filter((function(t){var e=Object(v.a)(t,2);e[0];return e[1]})).map((function(t){var e=Object(v.a)(t,2),n=e[0];e[1];return n}))})).join(" ")}function p(t,e){if(null==e){var n=[0,t];t=n[0],e=n[1]}return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t))+t}var m,b=n(14);!function(t){t[t.Open=1]="Open",t[t.Mark=2]="Mark",t[t.Lookup=3]="Lookup",t[t.Suggest=4]="Suggest"}(m||(m={}));var k=function(){function t(e,n){var i=this;Object(u.a)(this,t),this.timerId=0,this.values=[],this.value=0,this.duration=64,this.resultCb=void 0,this.changePhaseCb=void 0,this.phase=null,this.logging=!1,this.resultsValues={contextmenu:m.Mark,dblclick:m.Lookup,click:m.Open},this.buttonsMapping={0:1,1:4,2:2,3:8,4:16},this.goDown=function(t){i.log("down",t),i.phase=!1,i.values.push(i.buttonsMapping[t.button]),i.startTimer((function(){i.value=i.values[0],i.values.length>1&&(i.value=i.values.reduce((function(t,e){return t|e}))),i.log("pre flush"),i.reset(!0),i.flush()}))},this.goUp=function(t){i.log("up",t),i.phase=!0,i.startTimer(i.flush)},this.catchResult=function(t){i.log("catch",t),i.value||(i.value=i.resultsValues[t.type]),i.phase=!0,i.flush(),i.reset(),t.stopPropagation(),t.preventDefault()},this.startTimer=function(t){i.timerId||(i.timerId=window.setTimeout(t,i.duration))},this.reset=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];i.values=[],i.timerId&&clearTimeout(i.timerId),i.timerId=0,t||(i.value=0,i.phase=null)},this.flush=function(){var t,e;(i.log("flush"),null===(t=i.changePhaseCb)||void 0===t||t.call(i,!!i.phase,i.value),i.phase)&&(null===(e=i.resultCb)||void 0===e||e.call(i,i.value),i.reset())},this.log=function(t,e){if(i.logging){if(!1===e)return console.log(t);var n=null!==e&&void 0!==e?e:{},s=n.button,o=n.buttons,r=n.type,a=i.value,l=i.phase,c={1:"Open",2:"Mark",3:"Lookup",4:"Suggest"}[a];console.log(t,{value:a,valueStr:c,phase:l,values:Object(b.a)(i.values)},e?{button:s,buttons:o,type:r,event:e}:new function t(){Object(u.a)(this,t)})}},this.resultCb=e,this.changePhaseCb=n}return Object(l.a)(t,[{key:"listeners",get:function(){return{onMouseDownCapture:this.goDown,onMouseUpCapture:this.goUp,onContextMenuCapture:this.catchResult,onDoubleClickCapture:this.catchResult}}}]),t}(),w=n(0),O=function(t){Object(c.a)(n,t);var e=Object(h.a)(n);function n(t){var i;return Object(u.a)(this,n),(i=e.call(this,t)).state={content:"",isSuggested:!1,count:0},i.enabled=!0,i.click=void 0,i.settings=void 0,i.element=void 0,i.open=function(){i.settings.isOpen=!0,i.setState({content:i.settings.isMine?"\ud83d\udca3":(i.settings.value||"").toString(),isSuggested:!1})},i.mark=function(t){var e,n;if(!i.settings.isOpen){i.settings.isMarked=null!==t&&void 0!==t?t:!i.settings.isMarked;var s=null!==(e=null===(n=i.settings.board)||void 0===n?void 0:n.minesCount)&&void 0!==e?e:0;i.setState({count:s,isSuggested:!1,content:i.settings.isMarked?"\ud83d\udea9":""}),null==t&&setTimeout(i.resetAnimation,0)}},i.lookup=function(){var t,e;if(i.settings.isOpen&&i.settings.value){var n=null===(t=i.settings.board)||void 0===t?void 0:t.getAround(i.settings),s=null!==(e=null===n||void 0===n?void 0:n.reduce((function(t,e){return t+Number(e.isMarked)}),0))&&void 0!==e?e:0;i.props.lookup&&i.settings.value===s&&i.props.lookup(i.settings)}},i.suggest=function(){i.settings.isOpen||i.settings.isMarked||i.setState({isSuggested:!i.state.isSuggested})},i.onClick=function(t){if(i.enabled)switch(t){case m.Open:i.settings.isMarked||(i.props.move&&i.props.move(i.settings),i.open());break;case m.Mark:i.mark();break;case m.Lookup:i.lookup();break;case m.Suggest:i.suggest()}},i.disable=function(){i.enabled=!1},i.resetAnimation=function(){var t,e,n;null===(t=i.element.current)||void 0===t||t.classList.remove("animate"),null===(e=i.element.current)||void 0===e||e.offsetWidth,null===(n=i.element.current)||void 0===n||n.classList.add("animate")},i.onPress=function(t,e){var n;e===m.Lookup&&(null===(n=i.settings.board)||void 0===n||n.getAround(i.settings).filter((function(t){return!t.isOpen&&!t.isMarked})).forEach((function(e){var n,i;null===(n=e.component)||void 0===n||null===(i=n.element.current)||void 0===i||i.classList.toggle("pressed",!t)})))},i.click=new k(i.onClick,i.onPress),i.settings=t.field,i.settings.component=Object(f.a)(i),i.element=s.a.createRef(),i}return Object(l.a)(n,[{key:"render",value:function(){var t={"--count":this.state.count,"--direction":this.settings.y<2?1:-1};return Object(w.jsx)("div",Object(d.a)(Object(d.a)({},this.click.listeners),{},{className:g("field","around".concat(this.settings.isMine?0:this.settings.value),{open:this.settings.isOpen,marked:this.settings.isMarked,suggested:this.state.isSuggested}),style:t,ref:this.element,children:this.state.content}))}}]),n}(s.a.Component),j=n(15),M=function t(e){Object(u.a)(this,t),this.value=0,this.x=0,this.y=0,this.isOpen=!1,this.isMine=!1,this.isMarked=!1,this.component=void 0,this.board=void 0,Object.assign(this,e)},y=function(t){Object(c.a)(n,t);var e=Object(h.a)(n);function n(){var t;Object(u.a)(this,n);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return(t=e.call.apply(e,[this].concat(s))).fields=[],t.board=[],t.minesFields=[],t.width=8,t.height=8,t.mines=8,t.getAround=function(e){var n=e.x,i=e.y;return[[n-1,i-1],[n,i-1],[n+1,i-1],[n-1,i],[n+1,i],[n-1,i+1],[n,i+1],[n+1,i+1]].filter((function(e){var n=Object(v.a)(e,2),i=n[0],s=n[1];return i>=0&&i<t.width&&s>=0&&s<t.height})).map((function(e){var n=Object(v.a)(e,2),i=n[0],s=n[1];return t.board[i][s]}))},t.lookup=function(e){var n=[];return function e(i){var s=t.getAround(i).filter((function(t){return!n.includes(t)&&!t.isMarked}));n.push.apply(n,Object(b.a)(s)),s.filter((function(t){return!t.value})).forEach(e)}(e),n},t}return Object(l.a)(n,[{key:"createBoard",value:function(t){Object.assign(this,t),this.fields=[],this.minesFields=[],this.board=[];for(var e=0;e<this.width;e++)this.board[e]=[];for(var n=0;n<this.height;n++)for(var i=0;i<this.width;i++)this.board[i][n]=new M({x:i,y:n,value:0,board:this}),this.fields.push(this.board[i][n])}},{key:"fillBoard",value:function(t){for(var e=this,n=this.mines;n;){var i=p(this.width),s=p(this.height);this.board[i][s].isMine||i===t.x||s===t.y||(this.minesFields.push(this.board[i][s]),this.board[i][s].isMine=!0,n--)}this.minesFields.forEach((function(t){e.getAround(t).forEach((function(t){return t.value++}))}))}},{key:"minesCount",get:function(){return this.mines-this.fields.filter((function(t){return t.isMarked})).length}}]),n}(Object(j.a)(Array)),x=function(t){Object(c.a)(n,t);var e=Object(h.a)(n);function n(t){var i;return Object(u.a)(this,n),(i=e.call(this,t)).board=new y,i.timer=0,i.timerId=0,i.state={won:null},i.tick=function(){i.timer++},i.move=function(t){if(i.timer||(i.board.fillBoard(t),i.timer=1,i.timerId=window.setInterval(i.tick,1e3)),t.isMine)return i.gameOver();i.checkWin(t)||t.value||i.lookup(t)},i.lookup=function(t){if(!t.isMarked){var e=i.board.lookup(t);return e.forEach((function(t){var e;return!t.isOpen&&(null===(e=t.component)||void 0===e?void 0:e.open())})),e.find((function(t){return t.isMine}))?i.gameOver():i.checkWin(),e}},i.board.createBoard(i.props),window.board=i.board,i}return Object(l.a)(n,[{key:"render",value:function(){var t=this,e={"--columns":this.props.width,"--rows":this.props.height,"--count":this.board.minesCount};return Object(w.jsx)("div",{className:g("board",{win:!0===this.state.won,loose:!1===this.state.won}),style:e,children:this.board.fields.map((function(e){return Object(w.jsx)(O,{field:e,move:t.move,lookup:t.lookup},"".concat(e.x,".").concat(e.y))}))})}},{key:"checkWin",value:function(t){if(!this.board.fields.find((function(e){return!e.isMine&&!e.isOpen&&t!==e})))return console.log("Win!",this.timer,"seconds"),this.stop(),this.setState({won:!0}),this.board.minesFields.forEach((function(t){var e;return null===(e=t.component)||void 0===e?void 0:e.mark(!0)})),!0}},{key:"stop",value:function(){clearInterval(this.timerId),this.board.fields.forEach((function(t){var e;return null===(e=t.component)||void 0===e?void 0:e.disable()}))}},{key:"gameOver",value:function(){this.setState({won:!1}),console.log("game over"),this.board.minesFields.forEach((function(t){var e;return null===(e=t.component)||void 0===e?void 0:e.open()})),this.stop()}}]),n}(s.a.Component),C={beginner:{width:9,height:9,mines:10},default:{width:12,height:8,mines:12},intermediate:{width:16,height:16,mines:40},expert:{width:30,height:16,mines:99}},S={beginner:{min:10,mines:.12},default:{min:12,mines:.125},intermediate:{min:16,mines:.15},expert:{min:20,mines:.2}},F={beginer:"beginner",small:"beginner",easy:"beginner",min:"beginner",medium:"intermediate",middle:"intermediate",big:"expert",max:"expert",herd:"expert"};var I=function(){var t=function(){var t=window.location.hash.replace("#","").toLowerCase();if(!t)return C.default;if(t in F&&(t=F[t]),t in C)return C[t];if(/^fill:?(\w+)?$/.test(t)){var e=S[RegExp.$1]||S[F[RegExp.$1]]||S.default,n=window,i=n.innerWidth,s=n.innerHeight,o=Math.max(i,s),r=Math.min(i,s),u=Math.floor(r/e.min),l=Math.floor(o/u),c=Math.floor(e.min*l*e.mines);return i>s?{mines:c,width:l,height:e.min}:{mines:c,width:e.min,height:l}}if(/^custom:/.test(t)){var h,d=null===(h=t.match(Object(a.a)(/^custom:([0-9]+)[\0-\/:-\uFFFF]([0-9]+)[\0-\/:-\uFFFF]([0-9]+)/,{width:1,height:2,mines:3})))||void 0===h?void 0:h.groups,f={};for(var v in d)f[v]=+d[v];return f}return C.default}(),e="land"===window.screen.orientation.type.substr(0,4);if(window.innerWidth<800&&e&&t.width<t.height){var n=[t.height,t.width];t.width=n[0],t.height=n[1]}return Object(w.jsx)("div",{className:"App",children:Object(w.jsx)(x,{width:t.width,height:t.height,mines:t.mines})})},A=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,31)).then((function(e){var n=e.getCLS,i=e.getFID,s=e.getFCP,o=e.getLCP,r=e.getTTFB;n(t),i(t),s(t),o(t),r(t)}))};r.a.render(Object(w.jsx)(s.a.StrictMode,{children:Object(w.jsx)(I,{})}),document.getElementById("root")),A()}},[[30,1,2]]]);
//# sourceMappingURL=main.6a7c92ab.chunk.js.map