{"version":3,"sources":["utils.ts","debounced-clicks.ts","field/field.tsx","board-state.ts","board/board.tsx","settings.ts","settings-selector/settings-selector.tsx","swipe.ts","wrapper/wrapper.tsx","keyboard.ts","App.tsx","reportWebVitals.ts","index.tsx"],"names":["classes","flatMap","item","String","Array","Object","entries","filter","map","name","join","arand","min","max","Math","ceil","floor","random","ClickValues","SelectionTypes","DebouncedClicks","boardState","timerId","values","value","duration","phase","target","logging","resultsValues","contextmenu","Mark","dblclick","Lookup","click","Open","buttonsMapping","0","1","2","3","4","goDown","event","log","elements","get","push","button","startTimer","length","reduce","a","b","reset","flush","goUp","catchResult","type","stopPropagation","preventDefault","cb","window","setTimeout","saveState","clearTimeout","onPress","onClick","console","buttons","valueStr","this","onMouseDownCapture","onMouseUpCapture","onContextMenuCapture","onDoubleClickCapture","GameState","Field","props","state","content","isSuggested","isCheat","count","enabled","settings","element","open","doMove","move","isOpen","setState","isMine","toString","mark","isMarked","board","minesCount","resetAnimation","lookup","around","getAround","marked","n","field","Number","suggest","cheat","action","Suggest","disable","current","classList","remove","offsetWidth","add","forEach","component","toggle","select","Green","React","createRef","cssSettings","y","className","suggested","style","ref","set","Component","IFieldSettings","x","assign","BoardState","fields","minesFields","Map","columns","rows","mines","found","runner","neighbour","includes","starter","unopenedEmpties","unmarkedMines","unopenedMines","mine","mineIndex","findIndex","splice","empty","clickedField","find","Board","timer","won","tick","updateInfo","minesLeft","fillBoard","setInterval","InProgress","gameOver","checkWin","createBoard","Pending","listeners","win","loose","Win","stop","clearInterval","Loose","modes","beginner","default","intermediate","expert","fillModes","synonyms","beginer","small","easy","medium","middle","big","herd","Settings","getInitialSettings","isLandscape","screen","orientation","substr","innerWidth","innerHeight","vw","vh","result","keys","size","area","mode","reverse","hash","location","replace","toLowerCase","test","calcSettings","RegExp","$1","maxSize","minSize","fieldSize","fieldsMaxSide","groups","match","customSettings","key","SettingsSelector","joiner","possible","changeCustom","changeSettings","variant","getVariantByBoard","history","pushState","reload","getHelp","help","onClose","getPossibleSettings","getMinesCount","info","restart","onChange","defaultValue","disabled","split","string","Swipe","document","body","addImmediately","startX","startY","handlers","threshold","handleTouchStart","touches","clientX","clientY","handleTouchEnd","changedTouches","endX","endY","diffX","abs","diffY","direction","querySelector","attach","addEventListener","removeEventListener","some","handler","Wrapper","close","catchEsc","onKeyUp","children","Keyboard","actions","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Home","PageUp","PageDown","End","CtrlHome","moveTo","CtrlEnd","CtrlPageUp","CtrlPageDown","Enter","CtrlEnter","Space","handleKeyboard","getActionName","init","actionName","andRun","Active","dx","dy","ctrlKey","altKey","shiftKey","App","showSettings","swipe","on","left","toggleSettings","right","isCheatOn","keyboard","closeSettings","toggleCheat","detach","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.bdb8fb7c.chunk.js","sourcesContent":["export function classes(...classes: Array<string | Array<string> | {[className: string]: boolean}>): string {\r\n    return classes.flatMap(item => {\r\n        if (String(item) === item || item instanceof Array) return item;\r\n        return Object.entries(item).filter(([name, value]) => value).map(([name, flag]) => name)\r\n    }).join(' ')\r\n}\r\n\r\nexport function range(a: number, b?: number) {\r\n    if (a < 0 && b == null) b = -1\r\n    if (b == null) [a, b] = [1, a]\r\n\r\n    const result = []\r\n    for (let i = a; i <= b; i++) result.push(i)\r\n    return result\r\n}\r\n\r\nexport function rand(min: number, max?: number) {\r\n    if (min < 0 && max == null) max = -1\r\n    if (max == null) [min, max] = [1, min]\r\n\r\n    min = Math.ceil(min)\r\n    max = Math.floor(max)\r\n    return Math.floor(Math.random() * (max - min + 1)) + min\r\n}\r\n\r\nexport function arand(min: number, max?: number) {\r\n    if (max == null) [min, max] = [0, min]\r\n\r\n    min = Math.ceil(min);\r\n    max = Math.floor(max);\r\n    return Math.floor(Math.random() * (max - min)) + min\r\n}\r\n","import {BoardState} from \"./board-state\";\r\nimport {Field} from \"./field/field\";\r\n\r\nexport enum ClickValues {\r\n    Open = 1,\r\n    Mark = 2,\r\n    Lookup = 3,\r\n    Suggest\r\n}\r\n\r\nexport abstract class ClickTarget {\r\n    public abstract onClick(action: ClickValues): void\r\n    public abstract onPress(state: boolean, action: ClickValues): void\r\n}\r\n\r\nexport class DebouncedClicks {\r\n    timerId = 0\r\n    values: Array<number> = []\r\n    value: ClickValues = 0\r\n    duration = 64\r\n    phase: boolean | null = null // false = touchstart / mousedown, true = touchend / mouseup, null - nothing\r\n    target: Field | null = null\r\n\r\n    private boardState: BoardState;\r\n    private logging = false\r\n    private resultsValues: {[type: string]: ClickValues} = {\r\n        contextmenu: ClickValues.Mark,\r\n        dblclick: ClickValues.Lookup,\r\n        click: ClickValues.Open\r\n    }\r\n\r\n    private buttonsMapping: {[buttons: number]: number} = {\r\n        0: 1, // left button\r\n        1: 4, // middle/wheel button\r\n        2: 2, // right button\r\n        3: 8, // back button\r\n        4: 16, // forward button\r\n    }\r\n\r\n    constructor(boardState: BoardState) {\r\n        this.boardState = boardState\r\n    }\r\n\r\n    get listeners() {\r\n        return {\r\n            onMouseDownCapture: this.goDown,\r\n            onMouseUpCapture: this.goUp,\r\n            onContextMenuCapture: this.catchResult,\r\n            onDoubleClickCapture: this.catchResult\r\n        }\r\n    }\r\n\r\n    goDown = (event: any): void => {\r\n        this.log('down', event)\r\n        if (this.phase === null) {\r\n            this.target = this.boardState.elements.get(event.target) as Field\r\n        }\r\n\r\n        this.phase = false\r\n        this.values.push(this.buttonsMapping[event.button])\r\n\r\n        this.startTimer(() => {\r\n            this.value = this.values[0]\r\n            if (this.values.length > 1) {\r\n                this.value = this.values.reduce((a, b) => a | b)\r\n            }\r\n\r\n            this.log('pre flush')\r\n            this.reset(true)\r\n            this.flush()\r\n        })\r\n    }\r\n\r\n    goUp = (event: any): void => {\r\n        this.log('up', event)\r\n        this.phase = true\r\n        this.startTimer(this.flush)\r\n    }\r\n\r\n    catchResult = (event: any): void => {\r\n        this.log('catch', event)\r\n\r\n        if (!this.target) this.target = this.boardState.elements.get(event.target) as Field\r\n        if (!this.value) this.value = this.resultsValues[event.type]\r\n        this.phase = true\r\n        this.flush()\r\n\r\n        this.reset()\r\n        event.stopPropagation();\r\n        event.preventDefault();\r\n    }\r\n\r\n    private startTimer = (cb: Function) => {\r\n        if (!this.timerId) {\r\n            this.timerId = window.setTimeout(cb, this.duration)\r\n        }\r\n    }\r\n\r\n    private reset = (saveState = false) => {\r\n        this.values = []\r\n\r\n        if (this.timerId) clearTimeout(this.timerId)\r\n        this.timerId = 0\r\n\r\n        if (!saveState) {\r\n            this.value = 0\r\n            this.phase = null\r\n            this.target = null\r\n        }\r\n    }\r\n\r\n    private flush = () => {\r\n        this.log('flush')\r\n        this.target?.onPress(!!this.phase, this.value)\r\n\r\n        if (this.phase) {\r\n            this.target?.onClick(this.value)\r\n            this.reset()\r\n        }\r\n    }\r\n\r\n    private log = (name: string, event?: any) => {\r\n        if (!this.logging) return\r\n        if (event === false) return console.log(name)\r\n\r\n        const {button, buttons, type} = event ?? {}\r\n        const {value, phase} = this\r\n        const valueStr = {1: 'Open', 2: 'Mark', 3: 'Lookup', 4: 'Suggest'}[value]\r\n\r\n        console.log(name,\r\n            {value, valueStr, phase, values: [...this.values]},\r\n            event ? {button, buttons, type, event} : new (class NoEvent {})()\r\n        )\r\n    }\r\n}","import React from \"react\";\r\nimport './field.scss'\r\nimport {classes} from \"../utils\";\r\nimport {IFieldSettings} from \"../board-state\";\r\nimport {ClickTarget, ClickValues} from \"../debounced-clicks\";\r\n\r\ninterface IFieldProps {\r\n    move?: Function;\r\n    lookup?: Function;\r\n    mark?: Function;\r\n    field: IFieldSettings;\r\n}\r\n\r\nexport enum SelectionTypes {\r\n    Green = 'green',\r\n    Red = 'red',\r\n    Active = 'active',\r\n}\r\n\r\nexport class Field extends React.Component<IFieldProps> implements ClickTarget {\r\n    state = {\r\n        content: '',\r\n        isSuggested: false,\r\n        isCheat: false,\r\n        count: 0\r\n    }\r\n\r\n    enabled = true;\r\n    settings: IFieldSettings\r\n    private readonly element: React.RefObject<HTMLDivElement>;\r\n\r\n    constructor(props: IFieldProps) {\r\n        super(props);\r\n        this.settings = props.field\r\n        this.settings.component = this\r\n        this.element = React.createRef();\r\n    }\r\n\r\n    render() {\r\n        const cssSettings = {\r\n            '--count': this.state.count,\r\n            '--direction': this.settings.y < 2 ? 1 : -1\r\n        } as React.CSSProperties;\r\n\r\n        return <div\r\n            className={classes(\r\n                'field',\r\n                `around${this.settings.isMine ? 0 : this.settings.value}`,\r\n                {\r\n                    open: this.settings.isOpen as boolean,\r\n                    marked: this.settings.isMarked as boolean,\r\n                    suggested: this.state.isSuggested,\r\n                    cheat: this.state.isCheat,\r\n                },\r\n            )}\r\n            style={cssSettings}\r\n            ref={this.element}\r\n        >{this.state.content}</div>\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.settings.board?.elements.set(this.element.current as HTMLDivElement, this)\r\n    }\r\n\r\n    open = (doMove = false) => {\r\n        if (doMove) this.props.move?.(this.settings)\r\n\r\n        this.settings.isOpen = true\r\n        this.setState({\r\n            content: this.settings.isMine ? '💣' : (this.settings.value || '').toString(),\r\n            isSuggested: false,\r\n            isCheat: false\r\n        })\r\n    }\r\n\r\n    mark = (state?: boolean) => {\r\n        if (this.settings.isOpen) return\r\n        this.settings.isMarked = state ?? !this.settings.isMarked\r\n        const count = this.settings.board?.minesCount ?? 0\r\n\r\n        this.setState({\r\n            count,\r\n            isSuggested: false,\r\n            isCheat: false,\r\n            content: this.settings.isMarked ? '🚩' : ''\r\n        })\r\n        if (state == null) setTimeout(this.resetAnimation, 0)\r\n    }\r\n\r\n    lookup = () => {\r\n        if (!this.settings.isOpen || !this.settings.value) return\r\n\r\n        const around = this.settings.board?.getAround(this.settings)\r\n        const marked = around?.reduce((n: number, field: IFieldSettings) => n + Number(field.isMarked), 0) ?? 0\r\n\r\n        if (this.props.lookup && this.settings.value === marked) {\r\n            return this.props.lookup(this.settings)\r\n        }\r\n    }\r\n\r\n    suggest = () => {\r\n        if (this.settings.isOpen || this.settings.isMarked) return\r\n        this.setState({isSuggested: !this.state.isSuggested})\r\n    }\r\n\r\n    cheat = () => {\r\n        if (this.settings.isOpen || this.settings.isMarked) return\r\n        this.setState({isCheat: !this.state.isCheat})\r\n    }\r\n\r\n    onClick = (action: ClickValues) => {\r\n        // console.log('onClick', {1: 'Open', 2: 'Mark', 3: 'Lookup', 4: 'Suggest'}[action])\r\n        // console.log({button})\r\n        if (!this.enabled) return;\r\n\r\n        switch (action) {\r\n            case ClickValues.Open:\r\n                if (!this.settings.isMarked) {\r\n                    this.open(true)\r\n                }\r\n                break\r\n            case ClickValues.Mark:\r\n                this.mark()\r\n                break\r\n            case ClickValues.Lookup:\r\n                this.lookup()\r\n                break\r\n            case ClickValues.Suggest:\r\n                this.suggest()\r\n                break\r\n        }\r\n    }\r\n\r\n    disable = () => {\r\n        this.enabled = false;\r\n    }\r\n\r\n    private resetAnimation = () => {\r\n        this.element.current?.classList.remove('animate')\r\n        void this.element.current?.offsetWidth\r\n        this.element.current?.classList.add('animate')\r\n    }\r\n\r\n    onPress = (state: boolean, action: ClickValues) => {\r\n        if (action !== ClickValues.Lookup) return\r\n        // console.log('onPress', {state, action}, state ? 'release' : 'press', {1: 'Open', 2: 'Mark', 3: 'Lookup', 4: 'Suggest'}[action])\r\n\r\n        this.settings.board\r\n            ?.getAround(this.settings)\r\n            .filter(field => !field.isOpen && !field.isMarked)\r\n            .forEach(field => {\r\n                field.component?.element.current?.classList.toggle('pressed', !state)\r\n            })\r\n    }\r\n\r\n    select = (type: SelectionTypes = SelectionTypes.Green, state: boolean = true) => {\r\n        this.element.current?.classList.toggle(type, state)\r\n    }\r\n}","import {arand} from \"./utils\";\r\nimport {Field} from \"./field/field\";\r\nimport React from \"react\";\r\n\r\nexport type TSettings = 'columns' | 'rows' | 'mines'\r\nexport enum GameState {\r\n    Pending = 'Pending',\r\n    InProgress = 'In Progress',\r\n    Win = 'You Win! 😎',\r\n    Loose = 'You Loose 🙁'\r\n}\r\n\r\nexport interface IBoardSettings {\r\n    columns: number;\r\n    rows: number;\r\n    mines: number;\r\n}\r\n\r\nexport class IFieldSettings {\r\n    value: number = 0 // 0 - empty, 1..8 - mines are near\r\n    x: number = 0\r\n    y: number = 0\r\n    isOpen?: boolean = false\r\n    isMine?: boolean = false\r\n    isMarked?: boolean = false\r\n\r\n    component?: Field\r\n    board?: BoardState\r\n\r\n    constructor(values: IFieldSettings) {\r\n        Object.assign(this, values);\r\n    }\r\n}\r\n\r\n// TODO: tick cause re-render board\r\n// TODO: each updateInfo cause global re-render\r\n\r\nexport class BoardState {\r\n    fields: Array<IFieldSettings> = []\r\n    board: Array<Array<IFieldSettings>> = []\r\n    minesFields: Array<IFieldSettings> = []\r\n    elements: Map<HTMLDivElement, React.Component> = new Map()\r\n\r\n    columns = 8\r\n    rows = 8\r\n    mines = 8\r\n\r\n\r\n    createBoard(settings: IBoardSettings, empty = false) {\r\n        Object.assign(this, settings);\r\n\r\n        // reset properties\r\n        this.fields = [];\r\n        this.minesFields = [];\r\n        this.board = [];\r\n        for (let x = 0; x < this.columns; x++) {\r\n            this.board[x] = []\r\n        }\r\n\r\n        // create fields\r\n        for (let y = 0; y < this.rows; y++) {\r\n            for (let x = 0; x < this.columns; x++) {\r\n                this.board[x][y] = new IFieldSettings({x, y, value: 0, board: this})\r\n                this.fields.push(this.board[x][y])\r\n            }\r\n        }\r\n    }\r\n\r\n    fillBoard(starter: IFieldSettings) {\r\n        // set mines\r\n        let n = this.mines;\r\n        while (n) {\r\n            const x = arand(this.columns)\r\n            const y = arand(this.rows)\r\n\r\n            if (!this.board[x][y].isMine && x !== starter.x && y !== starter.y) {\r\n                this.minesFields.push(this.board[x][y])\r\n                this.board[x][y].isMine = true;\r\n                n--;\r\n            }\r\n        }\r\n\r\n        // set values\r\n        this.minesFields.forEach(field => {\r\n            this.getAround(field).forEach(field => field.value++)\r\n        })\r\n    }\r\n\r\n    getAround = (field: IFieldSettings): Array<IFieldSettings> => {\r\n        const {x, y} = field;\r\n        return [\r\n            [x - 1, y - 1], [x, y - 1], [x + 1, y - 1],\r\n            [x - 1, y], /*  ;)  */  [x + 1, y],\r\n            [x - 1, y + 1], [x, y + 1], [x + 1, y + 1],\r\n        ].filter(([x, y]) => x >= 0 && x < this.columns && y >= 0 && y < this.rows)\r\n            .map(([x, y]) => this.board[x][y])\r\n    }\r\n\r\n    lookup = (field: IFieldSettings) => {\r\n        const found: Array<IFieldSettings> = []\r\n        const runner = (field: IFieldSettings) => {\r\n            const around = this.getAround(field).filter(neighbour => !found.includes(neighbour) && !neighbour.isMarked);\r\n            found.push(...around)\r\n            around.filter(neighbour => !neighbour.value).forEach(runner)\r\n        }\r\n\r\n        runner(field)\r\n        return found\r\n    }\r\n\r\n    get minesCount() {\r\n        return this.mines - this.fields.filter(field => field.isMarked).length\r\n    }\r\n\r\n    help() {\r\n        const unopenedEmpties = this.fields.filter(field => !field.isMine && !field.isOpen && !field.isMarked)\r\n        const unmarkedMines = this.minesFields.filter(field => !field.isMarked)\r\n        let unopenedMines = unmarkedMines.filter(field => this.getAround(field).filter(field => field.isOpen).length)\r\n        if (!unopenedMines.length) unopenedMines = unmarkedMines\r\n\r\n        const mine = unopenedMines[arand(unopenedMines.length)]\r\n        const target = unopenedEmpties[arand(unopenedEmpties.length)]\r\n\r\n        mine.isMine = false\r\n        target.isMine = true\r\n\r\n        this.getAround(mine).forEach(field => {\r\n            field.value--;\r\n            if (field.isOpen) field.component?.setState({content: field.value || ''})\r\n        })\r\n        this.getAround(target).forEach(field => {\r\n            field.value++;\r\n            if (field.isOpen) field.component?.setState({content: field.value || ''})\r\n        })\r\n\r\n        const mineIndex = this.minesFields.findIndex(field => field === mine)\r\n        this.minesFields.splice(mineIndex, 1, target)\r\n\r\n        this.getAround(mine)\r\n            .filter(field => !field.value && field.isOpen)\r\n            .forEach(empty => {\r\n                empty.component?.open(true)\r\n            })\r\n    }\r\n\r\n    checkWin(clickedField?: IFieldSettings): boolean {\r\n        const closedFound = this.fields.find(field => !field.isMine && (!field.isOpen && clickedField !== field))\r\n        if (!closedFound) {\r\n            this.minesFields.forEach(field => field.component?.mark(true))\r\n            return true\r\n        }\r\n\r\n        return false\r\n    }\r\n}","import React from \"react\";\r\nimport './board.scss'\r\nimport {Field} from \"../field/field\";\r\nimport {BoardState, GameState, IBoardSettings, IFieldSettings} from \"../board-state\";\r\nimport {classes} from \"../utils\";\r\nimport {DebouncedClicks} from \"../debounced-clicks\";\r\n\r\ninterface IBoardProps extends IBoardSettings {\r\n    board: BoardState\r\n    updateInfo: Function\r\n}\r\n\r\nexport class Board extends React.Component<IBoardProps> {\r\n    click: DebouncedClicks\r\n    timer = 0\r\n    timerId = 0\r\n\r\n    state = {\r\n        won: null\r\n    }\r\n\r\n    constructor(props: IBoardProps) {\r\n        super(props);\r\n        this.props.board.createBoard(this.props);\r\n        this.click = new DebouncedClicks(this.props.board)\r\n        this.props.updateInfo?.({\r\n            state: GameState.Pending,\r\n            minesLeft: this.props.mines\r\n        })\r\n        // @ts-ignore\r\n        window.board = this.props.board\r\n    }\r\n\r\n    render() {\r\n        // console.log('Board.render', this.props.board)\r\n        const settings = {\r\n            '--columns': this.props.columns,\r\n            '--rows': this.props.rows,\r\n            '--count': this.props.board.minesCount\r\n        } as React.CSSProperties;\r\n\r\n        return <div\r\n            {...this.click.listeners}\r\n            className={classes('board', {win: this.state.won === true, loose: this.state.won === false})}\r\n            style={settings}\r\n        >\r\n            {this.props.board.fields.map(field => (\r\n                <Field field={field} key={`${field.x}.${field.y}`} move={this.move} lookup={this.lookup} mark={this.mark}/>\r\n            ))}\r\n        </div>;\r\n    }\r\n\r\n    tick = () => {\r\n        this.timer++\r\n        this.props.updateInfo?.({timer: this.timer})\r\n        // console.log('Seconds', this.timer)\r\n    }\r\n\r\n    mark = (minesLeft: number) => {\r\n        this.props.updateInfo?.({minesLeft})\r\n    }\r\n\r\n    checkWin(clickedField?: IFieldSettings) {\r\n        const isWin = this.props.board.checkWin(clickedField)\r\n        if (isWin) {\r\n            console.log('Win!', this.timer, 'seconds')\r\n            this.props.updateInfo?.({state: GameState.Win})\r\n            this.stop()\r\n            this.setState({won: true})\r\n            return true\r\n        }\r\n    }\r\n\r\n    move = (field: IFieldSettings) => {\r\n        if (!this.timer) {\r\n            this.props.board.fillBoard(field)\r\n            this.timer = 1\r\n            this.timerId = window.setInterval(this.tick, 1000)\r\n            this.props.updateInfo?.({state: GameState.InProgress})\r\n        }\r\n\r\n        if (field.isMine) return this.gameOver()\r\n\r\n        if (!this.checkWin(field)) {\r\n            if (!field.value) this.lookup(field)\r\n        }\r\n    }\r\n\r\n    lookup = (field: IFieldSettings) => {\r\n        if (field.isMarked) return;\r\n\r\n        const found = this.props.board.lookup(field)\r\n        found.forEach(field => !field.isOpen && field.component?.open())\r\n\r\n        const hasMine = found.find((field: IFieldSettings) => field.isMine)\r\n        if (hasMine) this.gameOver()\r\n        else this.checkWin()\r\n\r\n        return found\r\n    }\r\n\r\n    private stop() {\r\n        clearInterval(this.timerId)\r\n        this.props.board.fields.forEach(field => field.component?.disable())\r\n    }\r\n\r\n    private gameOver() {\r\n        this.setState({won: false})\r\n        this.props.updateInfo?.({state: GameState.Loose})\r\n        console.log('game over')\r\n        this.props.board.minesFields.forEach(field => field.component?.open())\r\n        this.stop()\r\n    }\r\n}\r\n","import {IBoardSettings, TSettings} from \"./board-state\";\r\n\r\nexport type Difficulty = 'beginner' | 'default' | 'intermediate' | 'expert'\r\n\r\nexport const modes: {[difficulty in Difficulty]: IBoardSettings} = {\r\n    beginner: {columns: 9, rows: 9, mines: 10},\r\n    default: {columns: 12, rows: 8, mines: 12},\r\n    intermediate: {columns: 16, rows: 16, mines: 40},\r\n    expert: {columns: 30, rows: 16, mines: 99},\r\n}\r\n\r\nexport const fillModes: {[difficulty in Difficulty]: {min: number, mines: number}} = {\r\n    beginner: {min: 10, mines: 0.12},\r\n    default: {min: 12, mines: 0.125},\r\n    intermediate: {min: 16, mines: 0.15},\r\n    expert: {min: 20, mines: 0.2}\r\n}\r\n\r\nconst synonyms: {[key: string]: Difficulty} = {\r\n    beginer: 'beginner',\r\n    small: 'beginner',\r\n    easy: 'beginner',\r\n    min: 'beginner',\r\n    medium: 'intermediate',\r\n    middle: 'intermediate',\r\n    big: 'expert',\r\n    max: 'expert',\r\n    herd: 'expert'\r\n}\r\n\r\nexport interface IPossibleBoardSettings extends Omit<IBoardSettings, 'mines'>{\r\n    mines: {[difficulty in Difficulty]: number}\r\n}\r\n\r\nexport class Settings implements IBoardSettings {\r\n    public columns!: number\r\n    public rows!: number\r\n    public mines!: number\r\n\r\n    constructor() {\r\n        const settings = Settings.getInitialSettings()\r\n\r\n        // fix for mobile landscape\r\n        const isLandscape = window.screen.orientation\r\n            ? window.screen.orientation.type.substr(0, 4) === 'land'\r\n            : window.innerWidth > window.innerHeight\r\n\r\n        const isMobile = window.innerWidth < 800\r\n\r\n        if (isMobile && isLandscape && settings.columns < settings.rows) {\r\n            [settings.columns, settings.rows] = [settings.rows, settings.columns]\r\n        }\r\n\r\n        Object.assign(this, settings)\r\n\r\n        // @ts-ignore\r\n        window.settings = this\r\n    }\r\n\r\n    public getPossibleSettings(): Array<IPossibleBoardSettings> {\r\n        const vw = window.innerWidth, vh = window.innerHeight\r\n        const result = []\r\n        const modes = Object.keys(fillModes) as Array<keyof IPossibleBoardSettings['mines']>\r\n        for (let columns = 100; columns >= 2; columns--)\r\n            for (let rows = 100; rows >= 2; rows--) {\r\n                const found = result.find(result => result.columns === columns || result.rows === rows)\r\n                // console.log({columns, rows, found})\r\n                if (found) continue;\r\n\r\n                const size = Math.min(vh / rows, vw / columns)\r\n                const width = columns * size\r\n                const height = rows * size\r\n                if (vw - width < 10 && vh - height < 10) {\r\n                    const area = columns * rows\r\n                    const settings = {columns, rows, mines: {}} as IPossibleBoardSettings\r\n                    modes.forEach(mode => settings.mines[mode] = Math.floor(fillModes[mode].mines * area))\r\n                    result.push(settings)\r\n                }\r\n            }\r\n\r\n        return result.reverse()\r\n    }\r\n\r\n    static getInitialSettings(): IBoardSettings {\r\n        let hash = window.location.hash.replace('#', '').toLowerCase()\r\n\r\n        if (!hash) return modes.default\r\n        if (hash in synonyms) hash = synonyms[hash]\r\n        if (hash in modes) return modes[hash as Difficulty]\r\n\r\n        if (/^fill:?(\\w+)?$/.test(hash)) {\r\n            const calcSettings = fillModes[RegExp.$1 as Difficulty] || fillModes[synonyms[RegExp.$1] as Difficulty] || fillModes.default\r\n            const {innerWidth, innerHeight} = window\r\n            const maxSize = Math.max(innerWidth, innerHeight)\r\n            const minSize = Math.min(innerWidth, innerHeight)\r\n\r\n            const fieldSize = Math.floor(minSize / calcSettings.min)\r\n            const fieldsMaxSide = Math.floor(maxSize / fieldSize)\r\n\r\n            const mines = Math.floor(calcSettings.min * fieldsMaxSide * calcSettings.mines)\r\n\r\n            return innerWidth > innerHeight\r\n                ? {\r\n                    mines,\r\n                    columns: fieldsMaxSide,\r\n                    rows: calcSettings.min\r\n                }\r\n                : {\r\n                    mines,\r\n                    columns: calcSettings.min,\r\n                    rows: fieldsMaxSide\r\n                }\r\n        }\r\n\r\n        if (/^custom:/.test(hash)) {\r\n            const groups = hash.match(/^custom:(?<columns>\\d+)\\D(?<rows>\\d+)\\D(?<mines>\\d+)/)?.groups as {[key in TSettings]: string}\r\n            let customSettings = {} as IBoardSettings\r\n            for (let key in groups) customSettings[key as keyof IBoardSettings] = +groups[key as TSettings]\r\n            return customSettings\r\n        }\r\n\r\n        return modes.default\r\n    }\r\n}\r\n","import React from \"react\";\r\nimport './settings-selector.scss'\r\nimport {Difficulty, IPossibleBoardSettings, Settings} from \"../settings\";\r\nimport {BoardState, GameState} from \"../board-state\";\r\n\r\nexport interface IInfo {\r\n    timer: number\r\n    minesLeft: number\r\n    state: GameState\r\n}\r\n\r\ninterface ISettingsSelectorProps {\r\n    settings: Settings\r\n    info: IInfo\r\n    board: BoardState\r\n    onClose: Function\r\n}\r\n\r\ninterface IState {\r\n    board: string | null\r\n    mines: Difficulty | null\r\n}\r\n\r\nexport class SettingsSelector extends React.Component<ISettingsSelectorProps> {\r\n    joiner = 'x'\r\n    possible: Array<IPossibleBoardSettings> = []\r\n    state: IState\r\n\r\n    constructor(props: ISettingsSelectorProps) {\r\n        super(props);\r\n\r\n        this.possible = this.props.settings.getPossibleSettings()\r\n        let board: string | null = [this.props.settings.columns, this.props.settings.rows].join(this.joiner)\r\n        if (!this.getVariantByBoard(board)) board = null\r\n\r\n        const difficulty: {[mines: string]: Difficulty} = {\r\n            [this.getMinesCount('beginner', board)]: 'beginner',\r\n            [this.getMinesCount('intermediate', board)]: 'intermediate',\r\n            [this.getMinesCount('expert', board)]: 'expert',\r\n        }\r\n        const mines = difficulty[this.props.settings.mines]\r\n\r\n        this.state = {board, mines}\r\n    }\r\n\r\n    render() {\r\n        return <div className=\"settings-selector\" onClick={event => event.stopPropagation()}>\r\n            {this.props.info.state !== GameState.Pending &&\r\n                <div>\r\n                    <h3>Game State: {this.props.info?.state !== GameState.InProgress ? this.props.info?.state : ''}</h3>\r\n                    <h4 className=\"sub\">Seconds from start: {this.props.info?.timer ?? '--'}</h4>\r\n                    {this.props.info?.state === GameState.InProgress &&\r\n                        <h4 className=\"sub\">Mines left: {this.props.board.minesCount}</h4>\r\n                    }\r\n                    {this.props.info?.state === GameState.InProgress &&\r\n                        <button className=\"button small\" onClick={this.getHelp}>Get Help</button>\r\n                    }\r\n                </div>\r\n            }\r\n\r\n            <h3>Standard difficulty levels:</h3>\r\n            <p className=\"link\" onClick={() => this.changeSettings('fill')}>Default</p>\r\n            <p className=\"link\" onClick={() => this.changeSettings('fill:beginner')}>Beginner</p>\r\n            <p className=\"link\" onClick={() => this.changeSettings('fill:intermediate')}>Intermediate</p>\r\n            <p className=\"link\" onClick={() => this.changeSettings('fill:expert')}>Expert</p>\r\n\r\n            <h3>Current board:</h3>\r\n            <p>{this.props.settings.columns}x{this.props.settings.rows} with {this.props.settings.mines} mines.</p>\r\n            <button className=\"button sup\" onClick={() => this.restart()}>Restart</button>\r\n\r\n            <h3>Custom board:</h3>\r\n            <label>\r\n                <h4>Board size:</h4>\r\n                <select onChange={this.changeCustom} name=\"board\" defaultValue={this.state.board as string}>\r\n                    {!this.state.board &&\r\n                        <option className=\"default\">-- Select Board --</option>\r\n                    }\r\n                    {this.possible.map(variant => {\r\n                        const name = [variant.columns, variant.rows].join(this.joiner)\r\n                        return <option key={name} value={name}>{name}</option>\r\n                    })}\r\n                </select>\r\n            </label>\r\n\r\n            <label>\r\n                <h4>Mines count:</h4>\r\n                <select onChange={this.changeCustom} name=\"mines\" defaultValue={this.state.mines as string}>\r\n                    {!this.state.mines &&\r\n                        <option className=\"default\">-- Select Mines --</option>\r\n                    }\r\n                    <option value=\"beginner\">\r\n                        Beginner {this.state.board && `(${this.getMinesCount('beginner')})`}\r\n                    </option>\r\n                    <option value=\"intermediate\">\r\n                        Intermediate {this.state.board && `(${this.getMinesCount('intermediate')})`}\r\n                    </option>\r\n                    <option value=\"expert\">\r\n                        Expert {this.state.board && `(${this.getMinesCount('expert')})`}\r\n                    </option>\r\n                </select>\r\n            </label>\r\n\r\n            <button className=\"button\" onClick={() => this.changeSettings('')}\r\n                    disabled={!this.state.board || !this.state.mines}>Apply Custom\r\n            </button>\r\n        </div>\r\n    }\r\n\r\n    changeCustom = (event: any) => {\r\n        this.setState({[event.target.name]: event.target.value})\r\n    }\r\n\r\n    changeSettings = (hash: string = 'fill:default') => {\r\n        if (!hash && this.state.board && this.state.mines) {\r\n            const variant = this.getVariantByBoard(this.state.board)\r\n            hash = 'custom:' + [variant?.columns, variant?.rows, variant?.mines[this.state.mines]].join(this.joiner)\r\n        }\r\n\r\n        window.history.pushState({}, 'Minesweeper', '#' + hash)\r\n        window.location.reload()\r\n    }\r\n\r\n    private getMinesCount(mines: Difficulty, board: string | null = this.state.board): string {\r\n        if (!board) return '--'\r\n        const variant = this.getVariantByBoard(board)\r\n        return variant?.mines[mines].toString() ?? '--'\r\n    }\r\n\r\n    getVariantByBoard(board: string): IPossibleBoardSettings | null {\r\n        const [columns, rows] = board.split(this.joiner).map(string => Number(string))\r\n        return this.possible.find(variant => variant.columns === columns && variant.rows === rows) ?? null\r\n    }\r\n\r\n    getHelp = () => {\r\n        this.props.board.help()\r\n        this.props.board.checkWin()\r\n        this.props.onClose()\r\n    }\r\n\r\n    private restart() {\r\n        window.location.reload()\r\n    }\r\n}","type Direction = 'up' | 'down' | 'left' | 'right'\r\ntype Handler = (event: TouchEvent) => void\r\ntype Handlers = {[direction in Direction]?: Handler}\r\n\r\nexport class Swipe {\r\n    private startX: number | null = null\r\n    private startY: number | null = null\r\n    private readonly element: HTMLElement | null = null\r\n    private handlers: Handlers = {}\r\n    private threshold = Math.min(window.innerWidth, window.innerHeight) / 5\r\n\r\n    constructor(element: HTMLElement | string = document.body, addImmediately = false) {\r\n        this.element = typeof element === 'string' ? document.querySelector(element) ?? null : (element as HTMLElement)\r\n        if (addImmediately) this.attach()\r\n    }\r\n\r\n    public attach() {\r\n        if (!this.element) return;\r\n        this.element.addEventListener('touchstart', this.handleTouchStart, false);\r\n        this.element.addEventListener('touchend', this.handleTouchEnd, false);\r\n    }\r\n\r\n    public detach() {\r\n        if (!this.element) return;\r\n        this.element.removeEventListener('touchstart', this.handleTouchStart, false);\r\n        this.element.removeEventListener('touchend', this.handleTouchEnd, false);\r\n    }\r\n\r\n    public on(direction: Direction, handler: Handler): Swipe\r\n    public on(handlers: Handlers): Swipe\r\n\r\n    public on(some: Direction | Handlers, handler?: Handler): Swipe {\r\n        if (some && handler) this.handlers[some as Direction] = handler\r\n        else Object.assign(this.handlers, some as Handlers)\r\n\r\n        return this\r\n    }\r\n\r\n    private handleTouchStart = (event: TouchEvent) => {\r\n        const {clientX: startX, clientY: startY} = event.touches[0]\r\n        Object.assign(this, {startX, startY})\r\n    }\r\n\r\n    private handleTouchEnd = (event: TouchEvent) => {\r\n        if (this.startX == null || this.startY == null) return;\r\n\r\n        const {clientX: endX, clientY: endY} = event.changedTouches[0]\r\n\r\n        let diffX = this.startX - endX\r\n        if (Math.abs(diffX) < this.threshold) diffX = 0\r\n\r\n        let diffY = this.startY - endY\r\n        if (Math.abs(diffY) < this.threshold) diffY = 0\r\n\r\n        const isHorizontal = Math.abs(diffX) > Math.abs(diffY)\r\n\r\n        const direction: Direction = isHorizontal\r\n            ? diffX > 0 ? 'left' : 'right'\r\n            : diffY > 0 ? 'up' : 'down'\r\n\r\n        // console.log('swipe', {diffX, diffY, dx: this.startX - endX, dy: this.startY - endY, th: this.threshold, isHorizontal, direction})\r\n        this.startX = null;\r\n        this.startY = null;\r\n\r\n        return this.handlers[direction]?.(event)\r\n    }\r\n}\r\n","import React from 'react'\r\nimport './wrapper.scss'\r\n\r\ninterface IWrapperProps {\r\n    onClose: Function\r\n}\r\n\r\nexport class Wrapper extends React.Component<IWrapperProps> {\r\n    render() {\r\n        return <div className=\"wrapper\" onClick={this.close} onKeyUp={this.catchEsc}>\r\n            {this.props.children}\r\n        </div>;\r\n    }\r\n\r\n    close = () => {\r\n        this.props.onClose?.()\r\n    }\r\n\r\n    catchEsc = (event: any) => {\r\n        if ((event as KeyboardEvent).key === 'Escape') this.close()\r\n    }\r\n}","import {BoardState} from \"./board-state\"\r\nimport {SelectionTypes} from \"./field/field\"\r\n\r\nexport class Keyboard {\r\n    x = 0\r\n    y = 0\r\n    private readonly element: HTMLElement | null = null\r\n    board!: BoardState\r\n\r\n    actions: {[action: string]: Function} = {\r\n        // movements: ← ↑ → ↓\r\n        ArrowUp: () => this.move(0, -1),\r\n        ArrowDown: () => this.move(0, 1),\r\n        ArrowLeft: () => this.move(-1, 0),\r\n        ArrowRight: () => this.move(1, 0),\r\n\r\n        // movements: ↖ ↗ ↘ ↙\r\n        Home: () => this.move(-1, -1),\r\n        PageUp: () => this.move(1, -1),\r\n        PageDown: () => this.move(1, 1),\r\n        End: () => this.move(-1, 1),\r\n\r\n        // movements: ⭰ ⭲ ⭱ ⭳\r\n        CtrlHome: () => this.moveTo(0, null),\r\n        CtrlEnd: () => this.moveTo(this.board.columns - 1, null),\r\n        CtrlPageUp: () => this.moveTo(null, 0),\r\n        CtrlPageDown: () => this.moveTo(null, this.board.rows - 1),\r\n\r\n        // game:\r\n        Enter: () => this.open(),\r\n        CtrlEnter: () => this.lookup(),\r\n        Space: () => this.mark(),\r\n    }\r\n\r\n    constructor(element: HTMLElement | string = document.body) {\r\n        this.element = typeof element === 'string' ? document.querySelector(element) ?? null : (element as HTMLElement)\r\n    }\r\n\r\n    public attach(board: BoardState, andRun = false) {\r\n        this.board = board\r\n        if (!this.element) return;\r\n        this.element.addEventListener('keydown', andRun ? this.handleKeyboard : this.init, false)\r\n        if (andRun) this.select()\r\n    }\r\n\r\n    public detach() {\r\n        if (!this.element) return;\r\n        this.element.removeEventListener('keydown', this.handleKeyboard, false)\r\n        this.element.removeEventListener('keydown', this.init, false)\r\n    }\r\n\r\n    private handleKeyboard = (event: KeyboardEvent) => {\r\n        this.actions[this.getActionName(event)]?.()\r\n    }\r\n\r\n    private init = (event: KeyboardEvent) => {\r\n        const actionName = this.getActionName(event)\r\n\r\n        if (!Object.keys(this.actions).includes(actionName)) return;\r\n        if (!this.element) return;\r\n\r\n        this.element.addEventListener('keydown', this.handleKeyboard, false)\r\n        this.element.removeEventListener('keydown', this.init, false)\r\n\r\n        this.select()\r\n    }\r\n\r\n    public select(state = true) {\r\n        this.board.board[this.x][this.y].component?.select(SelectionTypes.Active, state)\r\n    }\r\n\r\n    public moveTo(x: number | null, y: number | null) {\r\n        this.select(false)\r\n\r\n        if (x != null) this.x = x\r\n        if (y != null) this.y = y\r\n\r\n        this.select(true)\r\n    }\r\n\r\n    public move(dx: number, dy: number) {\r\n        this.select(false)\r\n\r\n        this.x += dx\r\n        this.y += dy\r\n\r\n        if (this.x < 0) this.x = 0\r\n        if (this.x === this.board.columns) this.x = this.board.columns - 1\r\n        if (this.y < 0) this.y = 0\r\n        if (this.y === this.board.rows) this.y = this.board.rows - 1\r\n\r\n        this.select(true)\r\n    }\r\n\r\n    private mark() {\r\n        this.board.board[this.x][this.y].component?.mark()\r\n        this.select()\r\n    }\r\n\r\n    private open() {\r\n        this.board.board[this.x][this.y].component?.open(true)\r\n        this.select()\r\n    }\r\n\r\n    private lookup() {\r\n        this.board.board[this.x][this.y].component?.lookup()\r\n    }\r\n\r\n    private getActionName(event: KeyboardEvent): string {\r\n        const ctrl = event.ctrlKey ? 'Ctrl' : ''\r\n        const alt = event.altKey ? 'Alt' : ''\r\n        const shift = event.shiftKey ? 'Shift' : ''\r\n        const key = event.key === ' ' ? 'Space' : event.key\r\n        return ctrl + alt + shift + key\r\n    }\r\n}","import React from 'react';\r\nimport './App.css';\r\n\r\nimport {Board} from \"./board/board\";\r\nimport {Settings} from \"./settings\";\r\nimport {IInfo, SettingsSelector} from \"./settings-selector/settings-selector\";\r\nimport {Swipe} from \"./swipe\";\r\nimport {Wrapper} from \"./wrapper/wrapper\";\r\nimport {BoardState, GameState} from \"./board-state\";\r\nimport {Keyboard} from \"./keyboard\";\r\n\r\nclass App extends React.Component {\r\n    board = new BoardState()\r\n    settings = new Settings()\r\n    state = {\r\n        showSettings: false,\r\n        timer: 0,\r\n        minesLeft: this.settings.mines,\r\n        state: GameState.Pending\r\n    }\r\n    swipe = new Swipe().on({\r\n        left: event => this.toggleSettings(event, false),\r\n        right: event => this.toggleSettings(event, true),\r\n    })\r\n    isCheatOn = false\r\n    keyboard = new Keyboard()\r\n\r\n    componentDidMount() {\r\n        document.body.addEventListener('keyup', this.toggleSettings)\r\n        this.swipe.attach()\r\n        this.keyboard.attach(this.board)\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        document.body.removeEventListener('keyup', this.toggleSettings)\r\n        this.swipe.detach()\r\n        this.keyboard.detach()\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"App\">\r\n                <Board board={this.board}\r\n                       columns={this.settings.columns}\r\n                       rows={this.settings.rows}\r\n                       mines={this.settings.mines}\r\n                       updateInfo={this.updateInfo}\r\n                />\r\n                {this.state.showSettings &&\r\n                    <Wrapper onClose={this.closeSettings}>\r\n                        <SettingsSelector settings={this.settings} info={this.state} board={this.board} onClose={this.closeSettings}/>\r\n                    </Wrapper>\r\n                }\r\n            </div>\r\n        )\r\n    }\r\n\r\n    closeSettings = () => {\r\n        this.setState({showSettings: false})\r\n    }\r\n\r\n    toggleCheat = () => {\r\n        this.board.minesFields.filter(mine => !mine.isMarked).forEach(mine => mine.component?.cheat())\r\n    }\r\n\r\n    toggleSettings = (event: KeyboardEvent | TouchEvent, value: boolean = !this.state.showSettings) => {\r\n        if (event.type === 'keyup') {\r\n            const {key} = event as KeyboardEvent\r\n            if (key.toLowerCase() === 'h' && this.state.state === GameState.InProgress) {\r\n                if (event.ctrlKey && event.shiftKey) {\r\n                    this.isCheatOn = !this.isCheatOn\r\n                    this.toggleCheat()\r\n                } else {\r\n                    if (this.isCheatOn) this.toggleCheat()\r\n                    this.board.help()\r\n                    if (this.isCheatOn) this.toggleCheat()\r\n                }\r\n                return\r\n            }\r\n            if (key !== 'Escape') return\r\n        }\r\n        this.setState({showSettings: value})\r\n    }\r\n\r\n    updateInfo = (info: IInfo) => {\r\n        this.setState(info)\r\n    }\r\n}\r\n\r\nexport default App;\r\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}